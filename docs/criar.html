<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Criar Ebook de Colorir | PetStory</title>
    <meta name="description" content="Crie seu ebook de colorir personalizado do seu pet. Envie as fotos e receba o PDF e site de homenagem em minutos!">
    
    <!-- SEO Meta Tags -->
    <meta name="keywords" content="criar ebook de colorir, pet, personalizado, PDF, site homenagem, upload fotos">
    <meta name="robots" content="index, follow">
    
    <!-- Preconnect para Performance -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&family=Fredoka:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        /* ========================================
           üìê STYLEGUIDE - VARI√ÅVEIS E PADR√ïES
           ======================================== */
        :root {
            /* Cores */
            --paper-white: #ffffff;
            --desk-bg: #fdf6e3;
            --ink-black: #2d2d2d;
            --pastel-pink: #ffdae0;
            --pastel-green: #d4eac8;
            --pastel-blue: #cceeff;
            --pastel-yellow: #fff5ba;
            --pastel-purple: #e6dff0;
            
            /* Espa√ßamentos */
            --space-xs: 0.5rem;
            --space-sm: 1rem;
            --space-md: 1.5rem;
            --space-lg: 2rem;
            --space-xl: 3rem;
            
            /* Sombras */
            --shadow-sm: 0 2px 4px rgba(0,0,0,0.05);
            --shadow-md: 8px 8px 0px rgba(45, 45, 45, 0.08);
            --shadow-sticker: 5px 5px 0px var(--ink-black);
            
            /* Bordas */
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 20px;
            --border-width: 3px;
        }

        /* ========================================
           üé® BASE STYLES
           ======================================== */
        body { 
            font-family: 'Fredoka', sans-serif;
            background-color: var(--desk-bg);
            color: var(--ink-black);
            overflow-x: hidden;
            background-image: radial-gradient(#d8d4c9 2px, transparent 2px);
            background-size: 24px 24px;
            min-height: 100vh;
            line-height: 1.6;
        }
        
        h1, h2, h3, h4, .handwritten { 
            font-family: 'Patrick Hand', cursive;
            line-height: 1.2;
        }

        /* ========================================
           ‚ú® ANIMA√á√ïES SUAVES
           ======================================== */
        @keyframes fadeInUp {
            from { 
                opacity: 0; 
                transform: translateY(20px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }
        
        .reveal {
            opacity: 0;
        }
        
        .reveal.active {
            animation: fadeInUp 0.6s ease-out forwards;
        }

        /* ========================================
           üìÑ PAPEL PRINCIPAL
           ======================================== */
        .master-paper {
            background-color: var(--paper-white);
            max-width: 900px;
            margin: 40px auto;
            border: var(--border-width) solid var(--ink-black);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-md);
            position: relative;
            padding: var(--space-xl);
            overflow: hidden;
            background-image: linear-gradient(#f4f4f4 1px, transparent 1px);
            background-size: 100% 40px;
        }
        
        .binder-holes {
            position: absolute;
            left: 15px;
            top: 0;
            bottom: 0;
            width: 40px;
            display: flex;
            flex-direction: column;
            justify-content: space-evenly;
            z-index: 10;
        }
        
        .hole {
            width: 25px;
            height: 25px;
            background-color: var(--desk-bg);
            border-radius: 50%;
            border: 2px solid #ccc;
            box-shadow: inset 2px 2px 5px rgba(0,0,0,0.1);
        }

        /* ========================================
           üîò BOT√ïES ADESIVO
           ======================================== */
        .btn-sticker {
            border: var(--border-width) solid var(--ink-black);
            border-radius: var(--radius-md);
            font-family: 'Patrick Hand', cursive;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: var(--shadow-sticker);
            transition: transform 0.2s cubic-bezier(0.34, 1.56, 0.64, 1), box-shadow 0.2s;
            position: relative;
            overflow: hidden;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--space-xs);
        }
        
        .btn-sticker:hover { 
            transform: translate(-2px, -2px) scale(1.05);
            box-shadow: 8px 8px 0px var(--ink-black);
        }
        
        .btn-sticker:active { 
            transform: translate(3px, 3px) scale(0.95);
            box-shadow: 2px 2px 0px var(--ink-black);
        }
        
        .btn-pink { background-color: var(--pastel-pink); color: var(--ink-black); }
        .btn-green { background-color: var(--pastel-green); color: var(--ink-black); }
        .btn-blue { background-color: var(--pastel-blue); color: var(--ink-black); }


        /* Acessibilidade */
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
                scroll-behavior: auto !important;
            }
        }

        /* ========================================
           üéâ ANIMA√á√ÉO DO MODAL DE SUCESSO
           ======================================== */
        @keyframes modalBounceIn {
            0% {
                opacity: 0;
                transform: scale(0.3) translateY(-50px);
            }
            50% {
                opacity: 1;
                transform: scale(1.05) translateY(0);
            }
            70% {
                transform: scale(0.95);
            }
            100% {
                transform: scale(1);
            }
        }
        
        .animate-modal-in {
            animation: modalBounceIn 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
        }
        
        @media (prefers-reduced-motion: reduce) {
            .animate-modal-in {
                animation: none;
                opacity: 1;
            }
        }
    </style>
</head>
<body>

    <main class="master-paper relative" id="paper-container">
        
        <!-- Furos do Caderno -->
        <div class="binder-holes hidden md:flex">
            <div class="hole"></div>
            <div class="hole"></div>
            <div class="hole"></div>
            <div class="hole"></div>
            <div class="hole"></div>
            <div class="hole"></div>
            <div class="hole"></div>
            <div class="hole"></div>
        </div>


        <!-- ========================================
             üìù HEADER
             ======================================== -->
        <header class="flex justify-between items-center mb-8 pl-0 md:pl-16 border-b-2 border-dashed border-gray-300 pb-6 reveal">
            <a href="index.html" class="text-3xl md:text-4xl font-hand font-bold flex items-center gap-2 text-gray-800 hover:opacity-80 transition-opacity">
                <i class="fas fa-paw text-pink-400" aria-hidden="true"></i> <span>PetStory</span>
            </a>
            <a href="index.html" class="font-hand text-lg md:text-xl underline decoration-wavy decoration-pink-400 hover:text-pink-500 text-gray-600 transition-colors">
                ‚Üê Voltar
            </a>
        </header>

        <!-- ========================================
             üéØ HERO SECTION
             ======================================== -->
        <section class="text-center pl-0 md:pl-16 mb-8 reveal">
            <h1 class="text-4xl md:text-5xl lg:text-6xl font-bold leading-tight mb-4 text-[#2d2d2d]">
                Crie seu Ebook de Colorir! üé®
            </h1>
            
            <!-- Pre√ßo no Hero -->
            <div class="mb-4 flex items-center justify-center gap-3 flex-wrap">
                <span class="text-2xl text-gray-400 line-through font-hand">R$ 94</span>
                <span class="text-4xl md:text-5xl font-hand font-bold text-pink-600">R$ 47</span>
                <span class="bg-red-100 text-red-600 px-2 py-1 rounded text-sm font-bold border border-red-300">50% OFF</span>
            </div>
            
            <p class="text-lg md:text-xl text-gray-700 mb-4 font-hand leading-relaxed max-w-2xl mx-auto">
                Envie as fotos do seu pet e receba um <strong>ebook de colorir (PDF)</strong> e um <strong>site de homenagem √∫nico e gratuito</strong> em poucos minutos!
            </p>
            
            <!-- Garantia -->
            <div class="mb-6">
                <span class="bg-green-100 text-green-700 px-4 py-2 rounded-lg text-sm font-bold border-2 border-green-300 inline-block">
                    ‚úÖ 100% de satisfa√ß√£o ou seu dinheiro de volta
                </span>
            </div>
        </section>

        <!-- ========================================
             üìã O QUE VOC√ä RECEBE
             ======================================== -->
        <section class="pl-0 md:pl-16 mb-8 reveal">
            <div class="max-w-2xl mx-auto bg-pink-50 border-2 border-pink-300 rounded-xl p-6 text-center">
                <h3 class="font-hand text-2xl md:text-3xl font-bold mb-4">Voc√™ vai receber:</h3>
                <div class="grid md:grid-cols-2 gap-4 text-left">
                    <div class="flex items-start gap-3 bg-white p-4 rounded-lg border border-pink-200">
                        <i class="fas fa-check-circle text-green-500 text-xl mt-1 flex-shrink-0"></i>
                        <div>
                            <strong class="font-hand text-lg">Ebook de Colorir (PDF)</strong>
                            <p class="text-sm text-gray-600 mt-1">Formato A4, pronto para imprimir. Imprima quantas vezes quiser!</p>
                        </div>
                    </div>
                    <div class="flex items-start gap-3 bg-white p-4 rounded-lg border border-pink-200">
                        <i class="fas fa-check-circle text-green-500 text-xl mt-1 flex-shrink-0"></i>
                        <div>
                            <strong class="font-hand text-lg">Site de Homenagem</strong>
                            <p class="text-sm text-gray-600 mt-1">P√°gina web √∫nica e personalizada do seu pet <span class="text-green-600 font-bold">(GR√ÅTIS)</span></p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================================
             ‚ú® COMO FUNCIONA (RESUMIDO)
             ======================================== -->
        <section class="pl-0 md:pl-16 mb-8 reveal">
            <div class="max-w-2xl mx-auto">
                <h3 class="font-hand text-2xl md:text-3xl font-bold text-center mb-6">Como funciona?</h3>
                <div class="flex flex-col md:flex-row gap-6 text-center">
                    <div class="flex-1 bg-white border-2 border-gray-200 rounded-lg p-4">
                        <div class="text-4xl mb-3">üì∏</div>
                        <p class="text-base font-hand font-bold mb-2">1. Envie as fotos</p>
                        <p class="text-sm text-gray-600">Pode ser do celular mesmo</p>
                    </div>
                    <div class="flex-1 bg-white border-2 border-gray-200 rounded-lg p-4">
                        <div class="text-4xl mb-3">üñçÔ∏è</div>
                        <p class="text-base font-hand font-bold mb-2">2. IA cria o ebook</p>
                        <p class="text-sm text-gray-600">Em apenas 5-10 minutos</p>
                    </div>
                    <div class="flex-1 bg-white border-2 border-gray-200 rounded-lg p-4">
                        <div class="text-4xl mb-3">üíå</div>
                        <p class="text-base font-hand font-bold mb-2">3. Receba no e-mail</p>
                        <p class="text-sm text-gray-600">PDF + link do site</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ========================================
             üì§ UPLOAD SECTION
             ======================================== -->
        <section class="pl-0 md:pl-16 mb-8 reveal">
            <div class="max-w-2xl mx-auto bg-white border-3 border-black rounded-xl p-6 md:p-8">
                <h2 class="font-hand text-3xl md:text-4xl font-bold text-center mb-6">Envie as Fotos do Seu Pet! üêæ</h2>
                
                <form id="uploadForm" class="space-y-5">
                    <!-- Nome do Pet -->
                    <div>
                        <label for="nomePet" class="block font-hand font-bold text-lg mb-2 text-gray-700">
                            Nome do Pet <span class="text-red-500">*</span>
                        </label>
                        <input 
                            type="text" 
                            id="nomePet" 
                            name="nome_pet" 
                            required
                            placeholder="Ex: Max, Luna, Bento..."
                            class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg font-hand text-lg focus:border-pink-400 focus:outline-none focus:ring-2 focus:ring-pink-200 transition"
                        >
                    </div>
                    
                    <!-- Data Especial -->
                    <div>
                        <label for="petDate" class="block font-hand font-bold text-lg mb-2 text-gray-700">
                            Uma Data Especial (opcional):
                        </label>
                        <p class="text-xs text-gray-500 mb-2 font-hand">Ex: anivers√°rio, dia que chegou em casa, etc.</p>
                        <input 
                            type="date" 
                            id="petDate" 
                            name="pet_date" 
                            class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg font-hand text-lg focus:border-pink-400 focus:outline-none focus:ring-2 focus:ring-pink-200 transition input-cozy"
                        >
                    </div>
                    
                    <!-- Hist√≥ria do Pet -->
                    <div>
                        <label for="petStory" class="block font-hand font-bold text-lg mb-2 text-gray-700">
                            Momentos Marcantes (Biografia):
                        </label>
                        <textarea 
                            id="petStory" 
                            name="pet_story" 
                            required
                            placeholder="Conta um pouco sobre a personalidade dele..."
                            maxlength="300"
                            rows="4"
                            class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg font-hand text-lg focus:border-pink-400 focus:outline-none focus:ring-2 focus:ring-pink-200 transition input-cozy h-32 resize-none"
                        ></textarea>
                        <p class="text-xs text-gray-500 mt-1 font-hand text-right">300 caracteres restantes</p>
                    </div>
                    
                    <!-- Email Input -->
                    <div>
                        <label for="userEmail" class="block font-hand font-bold text-lg mb-2 text-gray-700">
                            Seu E-mail <span class="text-red-500">*</span>
                        </label>
                        <input 
                            type="email" 
                            id="userEmail" 
                            name="email" 
                            required
                            placeholder="seu-email@exemplo.com"
                            class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg font-hand text-lg focus:border-pink-400 focus:outline-none focus:ring-2 focus:ring-pink-200 transition input-cozy"
                        >
                        <p class="text-sm text-gray-500 mt-1 font-hand">Para onde enviaremos o ebook (PDF) e o link do site de homenagem</p>
                    </div>
                    
                    <!-- File Upload -->
                    <div>
                        <label for="petFoto" class="block font-hand font-bold text-lg mb-2 text-gray-700">
                            Fotos do Pet <span class="text-red-500">*</span>
                        </label>
                        <div class="border-2 border-dashed border-gray-300 rounded-lg p-8 text-center hover:border-pink-400 transition cursor-pointer" id="dropZone">
                            <input 
                                type="file" 
                                id="petFoto" 
                                name="fotos" 
                                accept="image/*"
                                multiple
                                required
                                class="hidden"
                            >
                            <div id="dropZoneContent">
                                <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-4"></i>
                                <p class="font-hand text-lg text-gray-600 mb-2">
                                    Clique aqui ou arraste as fotos
                                </p>
                                <p class="text-sm text-gray-400">
                                    Formatos: JPG, PNG, WebP (m√°x. 10MB cada, at√© 10 fotos)
                                </p>
                            </div>
                        </div>
                        <div id="fileList" class="mt-4 space-y-2"></div>
                    </div>
                    
                    <!-- Submit Button -->
                    <button 
                        type="submit" 
                        id="submitBtn"
                        class="w-full btn-sticker btn-pink py-4 text-xl md:text-2xl hover:scale-105 transition shadow-lg font-bold"
                    >
                        Gerar Meu Ebook de Colorir! üé®
                    </button>
                    
                    <!-- Progress/Status -->
                    <div id="statusMessage" class="hidden text-center">
                        <div id="statusContent" class="font-hand text-lg"></div>
                        <div id="progressBar" class="mt-4 hidden">
                            <div class="w-full bg-gray-200 rounded-full h-3">
                                <div id="progressFill" class="bg-pink-500 h-3 rounded-full transition-all duration-300" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </section>


        <!-- ========================================
             üìû FOOTER
             ======================================== -->
        <footer class="text-center text-gray-400 font-hand text-base md:text-lg border-t border-dashed border-gray-300 pt-8 mt-8 pl-0 md:pl-16">
            <p>Feito com ‚ù§Ô∏è, Caf√© e Patinhas.</p>
            <p class="text-sm mt-1">¬© 2025 PetStory</p>
        </footer>

    </main>

    <script>
        /* ========================================
           üéØ SCRIPTS E INTERATIVIDADES
           ======================================== */
        
        /* Scroll Reveal - Suave */
        function reveal() {
            var reveals = document.querySelectorAll(".reveal");
            for (var i = 0; i < reveals.length; i++) {
                var windowHeight = window.innerHeight;
                var elementTop = reveals[i].getBoundingClientRect().top;
                var elementVisible = 100;
                if (elementTop < windowHeight - elementVisible) {
                    reveals[i].classList.add("active");
                }
            }
        }
        
        // Throttle para melhor performance
        let ticking = false;
        function optimizedReveal() {
            if (!ticking) {
                window.requestAnimationFrame(() => {
                    reveal();
                    ticking = false;
                });
                ticking = true;
            }
        }
        
        window.addEventListener("scroll", optimizedReveal, { passive: true });
        reveal();
        
        /* Smooth Scroll para links √¢ncora */
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    const offsetTop = target.offsetTop - 80;
                    window.scrollTo({
                        top: offsetTop,
                        behavior: 'smooth'
                    });
                }
            });
        });
        
        /* ========================================
           üì§ UPLOAD FORM FUNCTIONALITY
           ======================================== */
        
        // API Configuration
        const isDevelopment = window.location.hostname === 'localhost' || 
                             window.location.hostname === '127.0.0.1' ||
                             window.location.protocol === 'file:' ||
                             !window.location.hostname;
        
        let API_URL;
        if (isDevelopment) {
            API_URL = 'http://localhost:8000';
        } else {
            API_URL = 'https://seu-backend.com';
            console.warn('‚ö†Ô∏è Configure a URL do backend em produ√ß√£o!');
        }
        
        console.log('üîó API URL:', API_URL);
        
        const form = document.getElementById('uploadForm');
        const fileInput = document.getElementById('petFoto');
        const dropZone = document.getElementById('dropZone');
        const fileList = document.getElementById('fileList');
        const submitBtn = document.getElementById('submitBtn');
        const statusMessage = document.getElementById('statusMessage');
        const statusContent = document.getElementById('statusContent');
        const progressBar = document.getElementById('progressBar');
        const progressFill = document.getElementById('progressFill');
        
        let selectedFiles = [];
        
        // Drop Zone Events
        dropZone.addEventListener('click', () => fileInput.click());
        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.classList.add('border-pink-400', 'bg-pink-50');
        });
        dropZone.addEventListener('dragleave', () => {
            dropZone.classList.remove('border-pink-400', 'bg-pink-50');
        });
        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('border-pink-400', 'bg-pink-50');
            const files = Array.from(e.dataTransfer.files).filter(file => 
                file.type.startsWith('image/')
            );
            if (files.length > 0) {
                handleFiles(files);
            }
        });
        
        // File Input Change
        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleFiles(Array.from(e.target.files));
            }
        });
        
        function handleFiles(files) {
            // Limit to 10 files maximum
            if (files.length > 10) {
                showStatus('Voc√™ pode enviar no m√°ximo 10 fotos. As primeiras 10 ser√£o selecionadas.', 'error');
                files = files.slice(0, 10);
            }
            
            // Validate each file size (max 10MB each)
            const validFiles = [];
            for (const file of files) {
                if (file.size > 10 * 1024 * 1024) {
                    showStatus(`A foto "${file.name}" excede 10MB e ser√° ignorada.`, 'error');
                    continue;
                }
                validFiles.push(file);
            }
            
            if (validFiles.length === 0) {
                showStatus('Nenhuma foto v√°lida selecionada.', 'error');
                return;
            }
            
            selectedFiles = validFiles;
            updateFileList();
            updateDropZoneContent();
        }
        
        function updateFileList() {
            fileList.innerHTML = '';
            
            if (selectedFiles.length === 0) return;
            
            // Criar grid de previews com imagens
            const countDiv = document.createElement('div');
            countDiv.className = 'text-center mb-4 font-hand text-lg text-gray-700 font-bold';
            countDiv.textContent = `${selectedFiles.length} ${selectedFiles.length === 1 ? 'foto selecionada' : 'fotos selecionadas'}`;
            fileList.appendChild(countDiv);
            
            const gridDiv = document.createElement('div');
            gridDiv.className = 'grid grid-cols-2 md:grid-cols-4 gap-4';
            
            let loadedCount = 0;
            
            selectedFiles.forEach((file, index) => {
                const fileItem = document.createElement('div');
                fileItem.className = 'relative group';
                fileItem.id = `file-item-${index}`;
                
                // Placeholder enquanto carrega
                fileItem.innerHTML = `
                    <div class="relative bg-gray-100 rounded-lg border-2 border-gray-200 overflow-hidden" style="aspect-ratio: 1;">
                        <div class="absolute inset-0 flex items-center justify-center">
                            <i class="fas fa-spinner fa-spin text-gray-400 text-2xl"></i>
                        </div>
                    </div>
                    <p class="text-xs text-gray-600 mt-1 truncate">${file.name}</p>
                `;
                
                // Criar preview da imagem
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.createElement('img');
                    img.src = e.target.result;
                    img.alt = file.name;
                    img.className = 'w-full h-full object-cover';
                    
                    const container = fileItem.querySelector('div');
                    container.innerHTML = '';
                    container.appendChild(img);
                    
                    // Bot√£o de remover
                    const removeBtn = document.createElement('button');
                    removeBtn.type = 'button';
                    removeBtn.onclick = () => removeFile(index);
                    removeBtn.className = 'absolute top-1 right-1 bg-red-500 text-white rounded-full w-7 h-7 flex items-center justify-center opacity-0 group-hover:opacity-100 transition shadow-lg';
                    removeBtn.innerHTML = '<i class="fas fa-times text-xs"></i>';
                    fileItem.appendChild(removeBtn);
                    
                    loadedCount++;
                };
                reader.onerror = function() {
                    // Se der erro ao carregar, mostrar √≠cone
                    const container = fileItem.querySelector('div');
                    container.innerHTML = '<div class="absolute inset-0 flex items-center justify-center"><i class="fas fa-image text-gray-400 text-2xl"></i></div>';
                };
                reader.readAsDataURL(file);
                
                    gridDiv.appendChild(fileItem);
                });
                
                fileList.appendChild(gridDiv);
        }
        
        window.removeFile = function(index) {
            selectedFiles.splice(index, 1);
            // Update file input
            const dataTransfer = new DataTransfer();
            selectedFiles.forEach(file => dataTransfer.items.add(file));
            fileInput.files = dataTransfer.files;
            updateFileList();
            updateDropZoneContent();
        };
        
        function updateDropZoneContent() {
            const dropZoneContent = document.getElementById('dropZoneContent');
            if (selectedFiles.length === 0) {
                dropZoneContent.innerHTML = `
                    <i class="fas fa-cloud-upload-alt text-4xl text-gray-400 mb-4"></i>
                    <p class="font-hand text-lg text-gray-600 mb-2">
                        Clique aqui ou arraste as fotos
                    </p>
                    <p class="text-sm text-gray-400">
                        Formatos: JPG, PNG, WebP (m√°x. 10MB cada, at√© 10 fotos)
                    </p>
                `;
            } else if (selectedFiles.length === 1) {
                dropZoneContent.innerHTML = `
                    <i class="fas fa-check-circle text-4xl text-green-500 mb-4"></i>
                    <p class="font-hand text-lg text-gray-700 mb-2">
                        Foto selecionada: ${selectedFiles[0].name}
                    </p>
                    <p class="text-sm text-gray-400">
                        Clique para adicionar mais ou arraste novas fotos
                    </p>
                `;
            } else {
                dropZoneContent.innerHTML = `
                    <i class="fas fa-check-circle text-4xl text-green-500 mb-4"></i>
                    <p class="font-hand text-lg text-gray-700 mb-2">
                        ${selectedFiles.length} fotos selecionadas
                    </p>
                    <p class="text-sm text-gray-400">
                        Clique para adicionar mais ou arraste novas fotos
                    </p>
                `;
            }
        }
        
        // Character counter for textarea
        const petStoryTextarea = document.getElementById('petStory');
        if (petStoryTextarea) {
            petStoryTextarea.addEventListener('input', function() {
                const counter = this.parentElement.querySelector('.text-right');
                if (counter) {
                    const remaining = 300 - this.value.length;
                    counter.textContent = `${remaining} caracteres restantes`;
                    if (remaining < 50) {
                        counter.classList.add('text-red-500');
                    } else {
                        counter.classList.remove('text-red-500');
                    }
                }
            });
        }
        
        // Form Submit
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const nomePet = document.getElementById('nomePet').value.trim();
            const petDate = document.getElementById('petDate').value.trim();
            const petStory = document.getElementById('petStory').value.trim();
            const email = document.getElementById('userEmail').value.trim();
            
            // Validation
            if (!nomePet) {
                showStatus('Por favor, insira o nome do pet.', 'error');
                return;
            }
            
            if (!petStory) {
                showStatus('Por favor, conte um pouco sobre a hist√≥ria do pet.', 'error');
                return;
            }
            
            if (!email || !email.includes('@')) {
                showStatus('Por favor, insira um e-mail v√°lido.', 'error');
                return;
            }
            
            if (selectedFiles.length === 0) {
                showStatus('Por favor, selecione pelo menos uma foto do pet.', 'error');
                return;
            }
            
            // Validate all file sizes
            const oversizedFiles = selectedFiles.filter(file => file.size > 10 * 1024 * 1024);
            if (oversizedFiles.length > 0) {
                showStatus(`Algumas fotos excedem 10MB: ${oversizedFiles.map(f => f.name).join(', ')}`, 'error');
                return;
            }
            
            // Disable submit button
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processando...';
            
            // Show progress
            showStatus('Enviando dados para processamento...', 'info');
            progressBar.classList.remove('hidden');
            progressFill.style.width = '20%';
            
            try {
                // Create FormData with all fields
                const formData = new FormData();
                formData.append('nome_pet', nomePet);
                formData.append('pet_date', petDate);
                formData.append('pet_story', petStory);
                formData.append('email', email);
                
                // Append all photos with the same key 'fotos'
                selectedFiles.forEach(file => {
                    formData.append('fotos', file);
                });
                
                // Send to backend
                const response = await fetch(`${API_URL}/api/upload`, {
                    method: 'POST',
                    body: formData,
                    mode: 'cors',
                    credentials: 'omit',
                });
                
                progressFill.style.width = '60%';
                
                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({ detail: 'Erro desconhecido' }));
                    throw new Error(errorData.detail || `Erro ${response.status}`);
                }
                
                const data = await response.json();
                progressFill.style.width = '100%';
                
                if (data.status === 'success') {
                    showStatus(
                        `‚úÖ ${data.message}`,
                        'success'
                    );
                    
                    // Reset form after 8 seconds
                    setTimeout(() => {
                        form.reset();
                        selectedFiles = [];
                        fileList.innerHTML = '';
                        updateDropZoneContent();
                        statusMessage.classList.add('hidden');
                        submitBtn.disabled = false;
                        submitBtn.innerHTML = 'Gerar Meu Ebook de Colorir! üé®';
                    }, 8000);
                } else {
                    throw new Error(data.message || 'Erro ao processar');
                }
                
            } catch (error) {
                console.error('Upload error:', error);
                showStatus(`‚ùå Erro: ${error.message}`, 'error');
                submitBtn.disabled = false;
                submitBtn.innerHTML = 'Gerar Meu Livro de Colorir! üé®';
            } finally {
                progressBar.classList.add('hidden');
                progressFill.style.width = '0%';
            }
        });
        
        function showStatus(message, type = 'info') {
            statusMessage.classList.remove('hidden');
            statusContent.innerHTML = message;
            
            // Remove previous type classes
            statusContent.classList.remove('text-blue-600', 'text-green-600', 'text-red-600');
            
            // Add appropriate class
            if (type === 'success') {
                statusContent.classList.add('text-green-600');
            } else if (type === 'error') {
                statusContent.classList.add('text-red-600');
            } else {
                statusContent.classList.add('text-blue-600');
            }
        }
    </script>

    <!-- ========================================
         üéâ MODAL DE SUCESSO (P√ìS-PAGAMENTO)
         ======================================== -->
    <div id="successModal" class="hidden fixed inset-0 z-[9999] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm">
        <div class="success-modal-content bg-white border-4 border-black rounded-[2rem] shadow-[8px_8px_0px_0px_rgba(0,0,0,1)] max-w-md w-full p-8 md:p-10 relative animate-modal-in">
            <!-- Bot√£o fechar (X) -->
            <button 
                id="closeModalBtn" 
                class="absolute top-4 right-4 w-8 h-8 flex items-center justify-center rounded-full bg-gray-100 hover:bg-gray-200 border-2 border-black transition-transform hover:scale-110"
                aria-label="Fechar modal"
            >
                <i class="fas fa-times text-gray-700"></i>
            </button>

            <!-- Emoji animado -->
            <div class="text-center mb-6">
                <div class="text-6xl md:text-7xl mb-4 animate-bounce inline-block">‚ú®üê∂</div>
            </div>

            <!-- T√≠tulo -->
            <h2 class="font-hand text-3xl md:text-4xl font-bold text-center mb-4 text-[#2d2d2d]">
                Pagamento Confirmado! üéâ
            </h2>

            <!-- Texto explicativo -->
            <p class="text-center text-gray-700 mb-6 leading-relaxed text-base md:text-lg">
                A m√°gica come√ßou! Nossos rob√¥s j√° est√£o desenhando o seu pet. O <strong>Kit Digital (PDF + Site)</strong> chegar√° no seu e-mail em cerca de <strong>5 a 10 minutos</strong>.
            </p>

            <!-- Card de Aviso Amarelo -->
            <div class="bg-yellow-100 border-2 border-yellow-400 rounded-xl p-4 mb-6 text-center">
                <div class="flex items-center justify-center gap-2 mb-2">
                    <i class="fas fa-exclamation-triangle text-yellow-600 text-xl"></i>
                    <p class="font-hand font-bold text-yellow-900 text-base md:text-lg">
                        Verifique sua caixa de Spam/Promo√ß√µes
                    </p>
                </div>
                <p class="text-sm text-yellow-800">
                    O e-mail pode demorar alguns segundos para chegar
                </p>
            </div>

            <!-- Bot√£o de a√ß√£o -->
            <button 
                id="modalOkBtn"
                class="w-full btn-sticker btn-pink py-4 text-lg md:text-xl font-bold hover:scale-105 transition shadow-lg"
            >
                Entendido! ‚ú®
            </button>
        </div>
    </div>

    <!-- Script para Modal de Sucesso -->
    <script>
        (function() {
            // Verificar par√¢metros na URL
            const urlParams = new URLSearchParams(window.location.search);
            const status = urlParams.get('status');
            const payment = urlParams.get('payment');
            
            // Verificar se deve mostrar o modal
            if (status === 'success' || payment === 'approved') {
                const modal = document.getElementById('successModal');
                if (modal) {
                    // Limpar URL sem recarregar a p√°gina
                    window.history.replaceState({}, document.title, window.location.pathname);
                    
                    // Mostrar modal
                    modal.classList.remove('hidden');
                    document.body.style.overflow = 'hidden'; // Prevenir scroll
                }
            }
            
            // Fun√ß√£o para fechar o modal
            function closeModal() {
                const modal = document.getElementById('successModal');
                if (modal) {
                    modal.classList.add('hidden');
                    document.body.style.overflow = ''; // Restaurar scroll
                }
            }
            
            // Event listeners
            const closeBtn = document.getElementById('closeModalBtn');
            const okBtn = document.getElementById('modalOkBtn');
            const modal = document.getElementById('successModal');
            
            if (closeBtn) {
                closeBtn.addEventListener('click', closeModal);
            }
            
            if (okBtn) {
                okBtn.addEventListener('click', closeModal);
            }
            
            // Fechar ao clicar fora do modal
            if (modal) {
                modal.addEventListener('click', function(e) {
                    if (e.target === modal) {
                        closeModal();
                    }
                });
            }
            
            // Fechar com ESC
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    const modal = document.getElementById('successModal');
                    if (modal && !modal.classList.contains('hidden')) {
                        closeModal();
                    }
                }
            });
        })();
    </script>
</body>
</html>

